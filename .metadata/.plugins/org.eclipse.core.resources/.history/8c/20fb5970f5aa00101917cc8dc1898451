#ifndef STM32_SPI_LINK_H
#define STM32_SPI_LINK_H

#include "stm32l4xx_hal.h"
#include <stdint.h>
#include <stdbool.h>
#include <stdio.h>
#include <string.h>

#define TX_MAX 1024
#define RX_MAX 1024

typedef enum {
	//Pi -> STM32 Commands
	SET_CONFIG = 0x01,
	SEND_TEXT = 0x02
};



# STM32 -> Pi Commands
CMD_LOG_MESSAGE = 0x81
CMD_STATUS_UPDATE = 0x82

typedef enum
{
	SEND_BYTE = 0x5A,
	POLL_BYTE = 0xA5,
	READ_BYTE = 0xA7
} opcode_t;

typedef enum
{
	STATUS_EMPTY = 0xFF,
	STATUS_READY = 0x01
} tx_state_t;


void link_init(SPI_HandleTypeDef *spi);
void link_task(opcode_t opcode);
void link_send_string(const char* s);

#endif

